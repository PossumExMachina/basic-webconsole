<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Monitoring Console</title>
  <link rel="stylesheet" href="css/styles.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" rel="stylesheet">
</head>
<body>

<header>
  <div class="container">
    <div id="branding">
      <h1 style="color: black">Server Resources Monitoring</h1>
    </div>
    <nav>
      <ul>
        <li class="current"><a href="overview.html">Resources</a></li>
      </ul>
    </nav>
  </div>
</header>

<div class="container">
  <!-- Tomcat overview -->
  <div class="container">
    <div class="card" id="tomcatStatus">
      <i class="fas fa-cat"></i>
      <h2>Tomcat Status: </h2>
      <p id="tomcatStatusText">Loading...</p>
      <div id="runningApplications">
        <h3>Running Applications</h3>
        <ul id="runningAppsList"></ul>
      </div>
      <div id="notRunningApplications">
        <h3>Dead Applications</h3>
        <ul id="notRunningAppsList"></ul>
      </div>
      <a href="/overview.html" class="button">Go back</a>
    </div>

    <!-- Panel for Tomcat stop/start -->
    <div class="card">
      <i class="fas fa-cat"></i><h2>Control panel: </h2>
      <form action="/tomcat/stop" method="post" class="button">
        <button type="submit" value="Stop Tomcat" >Stop Server</button>
      </form>

      <form action="/tomcat/start" method="post" class="button">
        <button type="submit" value="Start Tomcat" >Start Server</button>
      </form>
    </div>


    <!-- Panel for application deployment -->
    <div class="card">
      <i class="fas fa-cat"></i><h2>Deployment Panel: </h2>

      <form id="searchForm">
        <label for="path">Directory Path:</label>
        <input type="text" id="path" name="path">
        <button type="submit">Search</button>
      </form>

    </div>




  </div>


  <script src="/scripts/main.js"></script>

<script>
  document.getElementById('searchForm').addEventListener('submit', function(e) {
    e.preventDefault();
    var path = document.getElementById('path').value;
    searchFiles(path);
  });

  function searchFiles(path) {
    fetch('/api/search?path=' + encodeURIComponent(path))
            .then(response => response.json())
            .then(data => {
              var resultsDiv = document.getElementById('searchResults');
              resultsDiv.innerHTML = '<ul>' + data.map(file => '<li>' + file + '</li>').join('') + '</ul>';
            })
            .catch(error => console.error('Error:', error));
  }

</script>
</div>

</body>
</html>